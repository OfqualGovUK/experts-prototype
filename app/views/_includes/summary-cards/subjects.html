{% set qualTypeHtml %}
  {% if data.selectedSubject and (data.resultQualType != "T Level" and data.resultQualType != "End-point assessment") %}
    {{ data.selectedQualification }}
  {% else %}
    {{ data.resultQualType }}
  {% endif %}
{% endset %}

{% set qualTypeAssessmentOnlyHtml %}
  {% if data.assessmentQual == "Yes" %}
    {{ data.selectedQualificationAssessmentOnly }}
    {% else %}
    {% if data.selectedSubject and (data.resultQualType != "T Level" and data.resultQualType != "End-point assessment") %}
      {{ data.selectedQualificationAssessmentOnly }}
    {% else %}
      {{ data.resultQualType }}
    {% endif %}
  {% endif %}
{% endset %}

{% set levelHtml %}
  {% if data.selectedSubject and (data.resultQualType != "T Level" and data.resultQualType != "End-point assessment") %}
    <ul class="govuk-list">
      {# loops through and gets all the checked items  #}
      {% for level in data.selectedLevel %}
        <li>
          {{ level }}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    {{ data.resultLevel }}
  {% endif %}
{% endset %}

{% set levelAssessmentOnlyHtml %}
  {% if data.assessmentQual == "Yes" %}
    <ul class="govuk-list">
      {# loops through and gets all the checked items  #}
      {% for level in data.selectedLevelAssessmentOnly %}
        <li>
          {{ level }}
        </li>
      {% endfor %}
    </ul>
    {% else %}
    {% if data.selectedSubject and (data.resultQualType != "T Level" and data.resultQualType != "End-point assessment") %}
      <ul class="govuk-list">
        {# loops through and gets all the checked items  #}
        {% for level in data.selectedLevelAssessmentOnly %}
          <li>
            {{ level }}
          </li>
        {% endfor %}
      </ul>
      {% else %}
      {{ data.resultLevel }}
    {% endif %}
  {% endif %}
{% endset %}

{% set assessmentSubjectHtml %}
  {{ data.assessmentSubject }}
{% endset %}

{% set assessmentQualHtml %}
  {{ data.assessmentQual }}
{% endset %}

{% set expertiseTypeHtml %}
  <ul class="govuk-list">
    {# loops through and gets al the checked items  #}
    {% for type in data.expertiseType %}
      <li>
        {{ type }}
      </li>
    {% endfor %}
  </ul>
{% endset %}

{% set assessmentExpertiseHtml %}
  <ul class="govuk-list">
    {# loops through and gets all the checked items  #}
    {% for type in data.assessmentExpertiseType %}
      <li>
        {{ type }}
      </li>
    {% endfor %}
  </ul>
{% endset %}

{% set teachingExpertiseHtml %}
  <ul class="govuk-list">
    {# loops through and gets all the checked items  #}
    {% for type in data.teachingExpertiseType %}
      <li>
        {{ type }}
      </li>
    {% endfor %}
  </ul>
{% endset %}

{# If assessment only expertise, display the answers to additional questions #}
{% if data.referrer == "assessmentExpertise" %}
  {{ xGovukSummaryCard({
    rows: [
      {
        key: {
          text: "Does your assessment expertise relate to a subject?"
        },
        value: { 
          html: assessmentSubjectHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Does your assessment expertise relate to a subject?",
            href: "/application/search/assessment-subject"
          }]
        }
      },
      {
        key: {
          text: "Does your assessment expertise relate to specific qualifications?"
        },
        value: { 
          html: assessmentQualHtml 
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Does your assessment expertise relate to specific qualifications?",
            href: "/application/search/assessment-qualifications"
          }]
        }
      } if data.assessmentSubject == "No",
      {
        key: {
          text: "Which assessment activities or responsibilities have you completed in this subject?"
        },
        value: { 
          html: assessmentExpertiseHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Which assessment activities or responsibilities have you completed in this subject?",
            href: "/application/search/assessment-expertise"
          }]
        }
      } if data.assessmentQual == "No"
    ]
  }) }}
{% endif %}

{# If it is a subject  #}
{% if (data.selectedSubject and (data.referrer != "assessmentExpertise")) %}
  {{ xGovukSummaryCard({
    titleText: data.selectedSubject,
    actions: {
      items: [{
        text: "Delete choice ",
        visuallyHiddenText: data.selectedSubject,
        href: "/application/search/delete?delete=" + data.selectedSubject
      }]
    },
    rows: [
      {
        key: {
          text: "Subject"
        },
        value: { 
          text: data.resultName
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Subjects, apprenticeship or T Level",
            href: "/application/search/subject-search"
          }]
        }
      },
      {
        key: {
          text: "Qualification type"
        },
        value: { 
          html: qualTypeHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Qualification type",
            href: "/application/search/select-qualification"
          }]
        } if (data.resultQualType != "T Level" and data.resultQualType != "End-point assessment")
      },
      {
        key: {
          text: "Qualification level"
        },
        value: { 
          html: levelHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Qualification level",
            href: "/application/search/select-level"
          }]
        } if (data.resultQualType != "T Level" and data.resultQualType != "End-point assessment")
      },
      {
        key: {
          text: "What best describes your type of expertise for this subject?"
        },
        value: { 
          html: expertiseTypeHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "what best describes your type of expertise for this subject?",
            href: "/application/search/select-expertise-type"
          }]
        } 
      },
      {
        key: {
          text: "Which assessment activities or responsibilities have you completed in this subject?"
        },
        value: { 
          html: assessmentExpertiseHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Which assessment activities or responsibilities have you completed in this subject?",
            href: "/application/search/assessment-expertise"
          }]
        }
      } if data.isAssessment,
      {
        key: {
          text: "Which teaching, lecturing or training activities or responsibilities have you completed in this subject?"
        },
        value: { 
          html: teachingExpertiseHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Which teaching, lecturing or training activities or responsibilities have you completed in this subject?",
            href: "/application/search/teaching-expertise"
          }]
        }
      } if data.isTeaching
    ]
  }) }}
{% endif %}

{# If assessment only #}
{% if data.referrer == "assessmentExpertise" %}
{% if (data.assessmentSubject == "Yes" or data.assessmentQual == "Yes") %}
  {{ xGovukSummaryCard({
    titleText: data.selectedSubject,
    actions: {
      items: [{
        text: "Delete choice ",
        visuallyHiddenText: data.selectedSubject,
        href: "/application/search/delete?delete=" + data.selectedSubject
      }]
    },
    rows: [
      {
        key: {
          text: "Subject"
        },
        value: { 
          text: data.resultName
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Subjects, apprenticeship or T Level",
            href: "/application/search/subject-search"
          }]
        }
      } if data.assessmentSubject == "Yes",
      {
        key: {
          text: "Qualification type"
        },
        value: { 
          html: qualTypeAssessmentOnlyHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Qualification type",
            href: "/application/search/select-qualification?referrer=assessmentQualOnly"
          }]
        }
      },
      {
        key: {
          text: "Qualification level"
        },
        value: { 
          html: levelAssessmentOnlyHtml 
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Qualification level",
            href: "/application/search/select-level?referrer=assessmentQualOnly"
          }]
        }
      },
      {
        key: {
          text: "Which assessment activities or responsibilities have you completed in this subject?"
        },
        value: { 
          html: assessmentExpertiseHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Which assessment activities or responsibilities have you completed in this subject?",
            href: "/application/search/assessment-expertise"
          }]
        }
      } if data.isAssessment,
      {
        key: {
          text: "Which teaching, lecturing or training activities or responsibilities have you completed in this subject?"
        },
        value: { 
          html: teachingExpertiseHtml
        },
        actions: {
          items: [{
            text: "Change ",
            visuallyHiddenText: "Which teaching, lecturing or training activities or responsibilities have you completed in this subject?",
            href: "/application/search/teaching-expertise"
          }]
        }
      } if data.isTeaching
    ]
  }) }}
{% endif %}
{% endif %}